---
title: "Dr. Waldrop's Odor-capture Notebook"
output:
  html_notebook: default
  pdf_document: default
  html_document:
    df_print: paged
fig_width: 8.5
---

# Some initial plotting for the water condition

Loading data and shaping data frame:
```{r echo=TRUE, message=TRUE, warning=FALSE}
library(ggplot2) # for ggplots
library(cowplot) # for plot_grid()
library(viridis) # for the viridis color palette

# Sourcing data handling functions
source("./src/r-scripts/datahandling_functions.R")

three_dat <- read.csv("./results/r-csv-files/3hair_results/totalconc_3hairs_2023-02-16_cleaned.csv", skip = 0, header=T, row.names = 1)

```

## Methods

We created six hair arrays with different numbers of hairs and configurations. The number of hairs varied (3 and 25 hairs) in one or five rows of hairs. 

```{r, echo=FALSE}


```

## Preliminary Results

#### Total concentration graphs

Plotting angle, gap width and total concentration. 

```{r}
ggplot(three_dat, aes(angle, gap, color = total_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(angle, total_conc)) + geom_point()
ggplot(three_dat, aes(gap, total_conc)) + geom_point()
```

Plotting gap width, $Re$ and total concentration. 

```{r}
ggplot(three_dat, aes(gap, re, color = total_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(gap, total_conc)) + geom_point()
ggplot(three_dat, aes(re, total_conc)) + geom_point()
```

Plotting ant width, distance from ant and total concentration. 

```{r}
ggplot(three_dat, aes(ant, dist, color = total_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(ant, total_conc)) + geom_point()
ggplot(three_dat, aes(dist, total_conc)) + geom_point()
```

Plotting $Re$, diffusion coefficient and total concentration. 

```{r}
ggplot(three_dat, aes(re, diff_coef, color = total_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(re, total_conc)) + 
  geom_point() 
ggplot(three_dat, aes(diff_coef, total_conc, color = init_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
```
Plotting stink width, initial concentration and total concentration. 

```{r}
ggplot(three_dat, aes(stink_width, init_conc, color = total_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(stink_width, total_conc, color = init_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(init_conc, total_conc)) + geom_point()
```


#### Normalized concentration

Plotting stink width, initial concentration and normalized concentration. 

```{r}
ggplot(three_dat, aes(stink_width, init_conc, color = norm_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(stink_width, norm_conc, color = init_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(init_conc, norm_conc)) + geom_point()
```

Plotting angle, gap width and normalized concentration. 

```{r}
ggplot(three_dat, aes(gap, angle, color = norm_conc)) + 
  geom_point() + scale_color_gradient(low = "blue", high = "red")
ggplot(three_dat, aes(angle, norm_conc, color = gap)) + 
  geom_point() + scale_color_gradient(low = "blue", high = "red") 
ggplot(three_dat, aes(gap, norm_conc, color = angle)) + 
  geom_point() + scale_color_gradient(low = "blue", high = "red")
```

Plotting diffision coefficient, gap width and normalized concentration. 

```{r}
ggplot(three_dat, aes(gap, diff_coef, color = norm_conc)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(gap, norm_conc, color = stink_width)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
ggplot(three_dat, aes(diff_coef, norm_conc, color = gap)) + 
  geom_point() + scale_color_gradient(low = "black", high = "yellow")
```

#### Individual Hairs

Plotting angle, gap width and individual hairs. 

```{r}
hairs_3dat <- tidyr::pivot_longer(three_dat, cols = c("hair1", "hair2", "hair3"), names_to = "variable", values_to = "value")

ggplot(hairs_3dat, aes(angle, value, color = variable))+ 
  geom_point(alpha=0.2) + geom_smooth(method = "loess") + 
  theme_minimal()
```

