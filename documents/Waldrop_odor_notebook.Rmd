---
title: "Dr. Waldrop's Odor-capture Notebook"
output: html_notebook
fig_width: 6
---

# Some initial plotting for the water condition

Loading data and shaping data frame:
```{r echo=TRUE, message=TRUE, warning=FALSE}
library(ggplot2) # for ggplots
library(reshape2) # for melt()
library(viridis) # for the viridis color palette

# Sourcing data handling functions
source("../src/r-scripts/datahandling_functions.R")

n <- 165 # Number of simulations in set

# Loading individual data sets
waterdata_3 <- loadnshapedata(n,"totalconc_water",3,"2020-12-08")
waterdata_18 <- loadnshapedata(n,"totalconc_water",18,"2020-12-04")
waterdata_25 <- loadnshapedata(n,"totalconc_water",25,"2020-12-04")
airdata_3 <- loadnshapedata(n,"totalconc_air",3,"2020-12-08")
airdata_18 <- loadnshapedata(n,"totalconc_air",18,"2020-12-04")
airdata_25 <- loadnshapedata(n,"totalconc_air",25,"2020-12-04")

# Subsetting hair data only
waterhairs3 <- subset(waterdata_3, select = c(1:3,seq(from=6,to=(5+3))))
waterhairs18 <- subset(waterdata_18, select = c(1:3,seq(from=6,to=(5+18))))
waterhairs25 <- subset(waterdata_25, select = c(1:3,seq(from=6,to=(5+25))))
airhairs3 <- subset(airdata_3, select = c(1:3,seq(from=6,to=(5+3))))
airhairs18 <- subset(airdata_18, select = c(1:3,seq(from=6,to=(5+18))))
airhairs25 <- subset(airdata_25, select = c(1:3,seq(from=6,to=(5+25))))

# Subsetting row data only
waterrow3 <- subset(waterdata_3, select = c(1:3,seq(from=(6+3), 
                                                      to=length(waterdata_3[1,]))))
waterrow18 <- subset(waterdata_18, select = c(1:3,seq(from=(6+18), 
                                                      to=length(waterdata_18[1,]))))
waterrow25 <- subset(waterdata_25, select = c(1:3,seq(from=(6+25), 
                                                      to=length(waterdata_25[1,]))))
airrow3 <- subset(airdata_3, select = c(1:3,seq(from=(6+3), 
                                                      to=length(airdata_3[1,]))))
airrow18 <- subset(airdata_18, select = c(1:3,seq(from=(6+18), 
                                                      to=length(airdata_18[1,]))))
airrow25 <- subset(airdata_25, select = c(1:3,seq(from=(6+25), 
                                                      to=length(airdata_25[1,]))))

# Melting data
waterhairs3.melted<-melt(waterhairs3, id.vars = c("angle","gap","Re"))
waterhairs18.melted<-melt(waterhairs18, id.vars = c("angle","gap","Re"))
waterhairs25.melted<-melt(waterhairs25, id.vars = c("angle","gap","Re"))
airhairs3.melted<-melt(airhairs3, id.vars = c("angle","gap","Re"))
airhairs18.melted<-melt(airhairs18, id.vars = c("angle","gap","Re"))
airhairs25.melted<-melt(airhairs25, id.vars = c("angle","gap","Re"))
waterrow3.melted<-melt(waterrow3, id.vars = c("angle","gap","Re"))
waterrow18.melted<-melt(waterrow18, id.vars = c("angle","gap","Re"))
waterrow25.melted<-melt(waterrow25, id.vars = c("angle","gap","Re"))
airrow18.melted<-melt(airrow18, id.vars = c("angle","gap","Re"))
airrow25.melted<-melt(airrow25, id.vars = c("angle","gap","Re"))

```

## Hair plots

## 3-hair array
Plot Reynolds number versus odor concentration captured:
```{r echo=FALSE}
ggplot(waterhairs3.melted, aes(Re,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Reynolds number") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```
Plot gap-to-diameter ratio against value: 
```{r echo=TRUE}
ggplot(waterhairs3.melted, aes(gap, value, color = variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

Plot angle versus value:
```{r echo=FALSE}
ggplot(waterhairs3.melted, aes(angle, value, color = variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Angle of array to flow") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```


## 18-hair array
Plot Reynolds number versus odor concentration captured:
```{r echo=FALSE}
ggplot(waterhairs18.melted, aes(Re,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Reynolds number") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```
Plot gap-to-diameter ratio against value: 
```{r echo=TRUE}
ggplot(waterhairs18.melted, aes(gap, value, color = variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

Plot angle versus value:
```{r echo=FALSE}
ggplot(waterhairs18.melted, aes(angle, value, color = variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Angle of array to flow") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```


## 25-hair array


Plot Reynolds number versus odor concentration captured:
```{r echo=FALSE}
ggplot(waterhairs25.melted, aes(Re,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE) + 
  xlab("Reynolds number") + ylab("Odor conc captured per hair") 
```

Plot gap-to-diameter ratio against value: 
```{r echo=FALSE}
ggplot(waterhairs25.melted, aes(gap,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```


Plot angle versus value:
```{r echo=FALSE}
ggplot(waterhairs25.melted, aes(angle, value, color = variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE) + 
  xlab("Angle of array to flow") + ylab("Odor conc captured per hair") 
  
```
## Individual Row Plots


Plot row number versus value for both values:
```{r echo=FALSE, warning=FALSE}
ggplot(rowdatawater.melted, aes(variable, value, color = array)) +
  geom_point() + scale_color_viridis(name = "Array", discrete = TRUE) + 
  xlab("Row of array") + ylab("Odor conc captured per row") 
```

Plot gap-to-diameter ratio against value: 
```{r echo=FALSE, warning=FALSE}
ggplot(rowdatawater.melted, aes(gap,value,color=variable, shape=array)) +
  geom_point(size=2) + scale_color_viridis(name = "Row number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```
Plot gap-to-diameter ratio against value for just 18-hair array: 
```{r echo=FALSE, warning=FALSE}
subset18.rowdatawater <- rowdatawater.melted[rowdatawater.melted$array == "18hair",]
ggplot(subset18.rowdatawater, aes(gap,value,color=variable)) +
  geom_point(size=2) + scale_color_viridis(name = "Row number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```

Plot gap-to-diameter ratio against value for just 25-hair array: 
```{r echo=FALSE, warning=FALSE}
subset25.rowdatawater <- rowdatawater.melted[rowdatawater.melted$array == "25hair",]
ggplot(subset25.rowdatawater, aes(gap,value,color=variable)) +
  geom_point(size=2) + scale_color_viridis(name = "Row number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```
Plot Reynolds number against value for just 18-hair array: 
```{r echo=FALSE, warning=FALSE}
ggplot(subset18.rowdatawater, aes(Re,value,color=variable)) +
  geom_point(size=2) + scale_color_viridis(name = "Row number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```

Plot Reynolds number against value for just 25-hair array: 
```{r echo=FALSE, warning=FALSE}
ggplot(subset25.rowdatawater, aes(Re,value,color=variable)) +
  geom_point(size=2) + scale_color_viridis(name = "Row number", discrete = TRUE) + 
  xlab("Gap-to-diameter ratio") + ylab("Odor conc captured per hair") 
```

## Total Concentration Plots

Setup data frames: 
```{r echo=TRUE}
alldata.totalconc <- data.frame(parameters,waterdata_3$total.conc, waterdata_18$total.conc, waterdata_25$total.conc)
colnames(alldata.totalconc)<- c(colnames(parameters),"3hairs","18hairs","25hairs")
alldataconc.melted <- melt(alldata.totalconc, id.vars = c("angle","gap","Re"))
```

Total concentration for gap-to-diameter ratio versus odor captured, arrays as colors: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(gap, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) +
  xlab("Gap-to-diameter ratio") + ylab("Total odor captured (water)")
```

Total concentration for Re versus odor captured, arrays as colors: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(Re, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) + 
  xlab("Re") + ylab("Total odor captured (water)")
```

Total concentration for angle versus odor captured, arrays as color: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(angle, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) + 
  xlab("Angle") + ylab("Total odor captured (water)")
```

# The air condition

# 25-hair array
```{r echo=TRUE, warning=FALSE}
nohairs<-25
airdata.25 <- read.csv("../results/r-csv-files/25hair_results/totalconc_air_165_2020-12-02.csv")
waterhairs25 <- subset(waterdata.25, select = c(1:3,seq(from=5,to=(4+nohairs))))
waterhairs25.melted<-melt(waterhairs25, id.vars = c("angle","gap","Re"))
# 18-hair array
nohairs <- 18
airdata.18 <- read.csv("../results/r-csv-files/18hair_results/totalconc_air_165_2020-12-02.csv")
airhairs18 <- subset(airdata.18, select = c(1:3,seq(from=5,to=(4+nohairs))))
airhairs18.melted<-melt(airhairs18, id.vars = c("angle","gap","Re"))
```
## Hair plots

## 18-hair array

Plot Reynolds number versus odor concentration captured:
```{r echo=FALSE}
ggplot(airhairs18.melted, aes(Re,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Reynolds number") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

Plot gap width versus odor concentration captured:
```{r echo=FALSE}
ggplot(airhairs18.melted, aes(gap,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Gap-width-to-diameter Ratio") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```


Plot angle versus odor concentration captured:
```{r echo=FALSE}
ggplot(airhairs18.melted, aes(angle,value,color=variable)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Angle") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

```{r echo=FALSE}
airdata18.melted <- melt(airdata.18,  id.vars = c("angle","gap","Re"))
airtotconc.18 <- airdata18.melted[airdata18.melted$variable=="total.conc",]
ggplot(airtotconc.18, aes(Re, value)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Re") + ylab("Total Odor conc captured ") + 
  guides(color=guide_legend(ncol=2))
```

```{r echo=FALSE}
ggplot(airtotconc.18, aes(gap, value)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Gap-width-to-diameter ratio") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

```{r echo=FALSE}
ggplot(airtotconc.18, aes(angle, value)) +
  geom_point() + scale_color_viridis(name = "Hair number", discrete = TRUE, option = "A") + 
  xlab("Angle") + ylab("Odor conc captured per hair") + 
  guides(color=guide_legend(ncol=2))
```

## Total Concentration Plots

Setup data frames: 
```{r echo=TRUE}
alldata.totalconc <- data.frame(parameters,airdata_3$total.conc, airdata_18$total.conc, airdata_25$total.conc)
colnames(alldata.totalconc)<- c(colnames(parameters),"3hairs","18hairs","25hairs")
alldataconc.melted <- melt(alldata.totalconc, id.vars = c("angle","gap","Re"))
```

Total concentration for gap-to-diameter ratio versus odor captured, arrays as colors: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(gap, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) +
  xlab("Gap-to-diameter ratio") + ylab("Total odor captured (water)")
```

Total concentration for Re versus odor captured, arrays as colors: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(Re, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) + 
  xlab("Re") + ylab("Total odor captured (water)")
```

Total concentration for angle versus odor captured, arrays as color: 
```{r echo=FALSE}
ggplot(alldataconc.melted, aes(angle, value, color = variable)) +
  geom_point() + scale_color_viridis(discrete = TRUE) + 
  xlab("Angle") + ylab("Total odor captured (water)")
```