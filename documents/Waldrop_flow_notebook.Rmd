---
title: "Dr. Waldrop's Fluid-flow Notebook"
output: html_notebook
fig_width: 6
---

# Some initial plotting of fluid flow

Initial package loading and function definitions: 
```{r setup}
library(tidyr)
library(ggplot2) # for ggplots
library(patchwork)
library(viridis) # for the viridis color palette

# Sourcing data handling functions
source("../src/r-scripts/datahandling_functions.R")
```


```{r}
three_hair <- read.csv("./results/r-csv-files/3hair_results/flowdata_2022-11-11.csv")
twofive_hair <- read.csv("./results/r-csv-files/25hair_results/flowdata_2023-06-28.csv", row.names=1)

plot_parameter <- function(three_dat, twofive_dat, parameter, output){
  # 3 hair
  p3 <- ggplot(three_dat, aes_string(parameter, output)) + geom_point() +
    ggtitle("3 hair") + theme_minimal()
  # 25 hair
  p25 <- ggplot(twofive_dat, aes_string(parameter, output)) + geom_point() + 
    ggtitle("25 hair") + theme_minimal()
  return(p3 + p25)
}

plot_values <- function(dat, output, variable){
  col_list <- grep(output, colnames(dat))
  col_list <- c(1:6, col_list)
  dat_sub <- dat[,col_list]
  dat_longer <- pivot_longer(dat_sub, cols = !c(1:6), names_prefix = paste0(output,"_"))
  dat_longer$name <- factor(dat_longer$name)
  num <- nlevels(dat_longer$name)
  dat_longer$name <- factor(dat_longer$name, ordered = T, levels = seq(1,num))
  p1<- ggplot(dat_longer, aes_string(variable, "value", fill = "name",  color = "name")) + 
    geom_point(pch = 21) +
    scale_fill_viridis(discrete = T) + 
    scale_color_viridis(discrete = T) +
    ylab(output) + theme_minimal()
  return(p1)
}

```

## Single parameter plots

Plot leakiness row 1 for both arrays agains angle: 
```{r echo=FALSE, warning=FALSE}
plot_parameter(three_hair, twofive_hair, "angle", "leakiness_row_1")
```

Plot leakiness row 1 for both arrays against Re: 
```{r echo=FALSE, warning=FALSE}
plot_parameter(three_hair, twofive_hair, "re", "leakiness_row_1")
```
Plot leakiness row 1 for both arrays against distance from antenna: 
```{r echo=FALSE, warning=FALSE}
plot_parameter(three_hair, twofive_hair, "dist", "leakiness_row_1")
```

Plot leakiness row 1 for both arrays against antenna width: 
```{r echo=FALSE, warning=FALSE}
plot_parameter(three_hair, twofive_hair, "ant", "leakiness_row_1")
```

Plot leakiness row 1 for both arrays against gap width: 
```{r echo=FALSE, warning=FALSE}
plot_parameter(three_hair, twofive_hair, "gap", "leakiness_row_1")
```

Shear across hairs: 
```{r}
(plot_values(three_hair, "shear_hair", "re") + plot_values(twofive_hair, "shear_hair", "re") )/
  (plot_values(three_hair, "shear_hair", "angle") + plot_values(twofive_hair, "shear_hair", "angle") ) /
  (plot_values(three_hair, "shear_hair", "gap") + plot_values(twofive_hair, "shear_hair", "gap") ) + 
  plot_layout(guides = "collect")
```


U mean around hairs: 
```{r}
(plot_values(three_hair, "Umean_hair", "re") + plot_values(twofive_hair, "Umean_hair", "re") )/
  (plot_values(three_hair, "Umean_hair", "angle") + plot_values(twofive_hair, "Umean_hair", "angle") ) /
  (plot_values(three_hair, "Umean_hair", "gap") + plot_values(twofive_hair, "Umean_hair", "gap") ) + 
  plot_layout(guides = "collect")
```

Flux around hairs: 
```{r}
(plot_values(three_hair, "flux_hair", "re") + plot_values(twofive_hair, "flux_hair", "re") )/
  (plot_values(three_hair, "flux_hair", "angle") + plot_values(twofive_hair, "flux_hair", "angle") ) /
  (plot_values(three_hair, "flux_hair", "gap") + plot_values(twofive_hair, "flux_hair", "gap") ) + 
  plot_layout(guides = "collect")
```

Leakiness: 

```{r}
(plot_values(three_hair, "leakiness_row", "re") + plot_values(twofive_hair, "leakiness_row", "re") )/
  (plot_values(three_hair, "leakiness_row", "angle") + plot_values(twofive_hair, "leakiness_row", "angle") ) /
  (plot_values(three_hair, "leakiness_row", "ant") + plot_values(twofive_hair, "leakiness_row", "ant") ) /
  (plot_values(three_hair, "leakiness_row", "dist") + plot_values(twofive_hair, "leakiness_row", "dist") ) /
  (plot_values(three_hair, "leakiness_row", "gap") + plot_values(twofive_hair, "leakiness_row", "gap") ) + 
  plot_layout(guides = "collect")
```